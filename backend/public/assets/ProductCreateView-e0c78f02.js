import{h as ce,_ as ne,r as se,o as z,c as T,a as x,b as Y,F as K,d as $,i as N,v as V,j as le,f as te,p as fe,g as he,e as X,k as de,l as ge,m as re,t as me}from"./index-8fc6a3f4.js";import{q as ae}from"./index-4d8b1034.js";function Z(G){throw new Error('Could not dynamically require "'+G+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var oe={exports:{}};/*!

pica
https://github.com/nodeca/pica

*/(function(G,D){(function(h){G.exports=h()})(function(){return function(){function h(s,f,u){function A(i,n){if(!f[i]){if(!s[i]){var t=typeof Z=="function"&&Z;if(!n&&t)return t(i,!0);if(r)return r(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var v=f[i]={exports:{}};s[i][0].call(v.exports,function(l){var g=s[i][1][l];return A(g||l)},v,v.exports,h,s,f,u)}return f[i].exports}for(var r=typeof Z=="function"&&Z,e=0;e<u.length;e++)A(u[e]);return A}return h}()({1:[function(h,s,f){var u=h("multimath"),A=h("./mm_unsharp_mask"),r=h("./mm_resize");function e(i){var n=i||[],t={js:n.indexOf("js")>=0,wasm:n.indexOf("wasm")>=0};u.call(this,t),this.features={js:t.js,wasm:t.wasm&&this.has_wasm()},this.use(A),this.use(r)}e.prototype=Object.create(u.prototype),e.prototype.constructor=e,e.prototype.resizeAndUnsharp=function(n,t){var a=this.resize(n,t);return n.unsharpAmount&&this.unsharp_mask(a,n.toWidth,n.toHeight,n.unsharpAmount,n.unsharpRadius,n.unsharpThreshold),a},s.exports=e},{"./mm_resize":4,"./mm_unsharp_mask":9,multimath:19}],2:[function(h,s,f){function u(t){return t<0?0:t>255?255:t}function A(t){return t>=0?t:0}function r(t,a,v,l,g,p){var c,d,_,E,y,F,U,b,C,M,Q,P=0,k=0;for(C=0;C<l;C++){for(y=0,M=0;M<g;M++){for(F=p[y++],U=p[y++],b=P+F*4|0,c=d=_=E=0;U>0;U--)Q=p[y++],E=E+Q*t[b+3]|0,_=_+Q*t[b+2]|0,d=d+Q*t[b+1]|0,c=c+Q*t[b]|0,b=b+4|0;a[k+3]=A(E>>7),a[k+2]=A(_>>7),a[k+1]=A(d>>7),a[k]=A(c>>7),k=k+l*4|0}k=(C+1)*4|0,P=(C+1)*v*4|0}}function e(t,a,v,l,g,p){var c,d,_,E,y,F,U,b,C,M,Q,P=0,k=0;for(C=0;C<l;C++){for(y=0,M=0;M<g;M++){for(F=p[y++],U=p[y++],b=P+F*4|0,c=d=_=E=0;U>0;U--)Q=p[y++],E=E+Q*t[b+3]|0,_=_+Q*t[b+2]|0,d=d+Q*t[b+1]|0,c=c+Q*t[b]|0,b=b+4|0;c>>=7,d>>=7,_>>=7,E>>=7,a[k+3]=u(E+8192>>14),a[k+2]=u(_+8192>>14),a[k+1]=u(d+8192>>14),a[k]=u(c+8192>>14),k=k+l*4|0}k=(C+1)*4|0,P=(C+1)*v*4|0}}function i(t,a,v,l,g,p){var c,d,_,E,y,F,U,b,C,M,Q,P,k=0,L=0;for(M=0;M<l;M++){for(F=0,Q=0;Q<g;Q++){for(U=p[F++],b=p[F++],C=k+U*4|0,c=d=_=E=0;b>0;b--)P=p[F++],y=t[C+3],E=E+P*y|0,_=_+P*t[C+2]*y|0,d=d+P*t[C+1]*y|0,c=c+P*t[C]*y|0,C=C+4|0;_=_/255|0,d=d/255|0,c=c/255|0,a[L+3]=A(E>>7),a[L+2]=A(_>>7),a[L+1]=A(d>>7),a[L]=A(c>>7),L=L+l*4|0}L=(M+1)*4|0,k=(M+1)*v*4|0}}function n(t,a,v,l,g,p){var c,d,_,E,y,F,U,b,C,M,Q,P=0,k=0;for(C=0;C<l;C++){for(y=0,M=0;M<g;M++){for(F=p[y++],U=p[y++],b=P+F*4|0,c=d=_=E=0;U>0;U--)Q=p[y++],E=E+Q*t[b+3]|0,_=_+Q*t[b+2]|0,d=d+Q*t[b+1]|0,c=c+Q*t[b]|0,b=b+4|0;c>>=7,d>>=7,_>>=7,E>>=7,E=u(E+8192>>14),E>0&&(c=c*255/E|0,d=d*255/E|0,_=_*255/E|0),a[k+3]=E,a[k+2]=u(_+8192>>14),a[k+1]=u(d+8192>>14),a[k]=u(c+8192>>14),k=k+l*4|0}k=(C+1)*4|0,P=(C+1)*v*4|0}}s.exports={convolveHor:r,convolveVert:e,convolveHorWithPre:i,convolveVertWithPre:n}},{}],3:[function(h,s,f){s.exports="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"},{}],4:[function(h,s,f){s.exports={name:"resize",fn:h("./resize"),wasm_fn:h("./resize_wasm"),wasm_src:h("./convolve_wasm_base64")}},{"./convolve_wasm_base64":3,"./resize":5,"./resize_wasm":8}],5:[function(h,s,f){var u=h("./resize_filter_gen"),A=h("./convolve"),r=A.convolveHor,e=A.convolveVert,i=A.convolveHorWithPre,n=A.convolveVertWithPre;function t(v,l,g){for(var p=3,c=l*g*4|0;p<c;){if(v[p]!==255)return!0;p=p+4|0}return!1}function a(v,l,g){for(var p=3,c=l*g*4|0;p<c;)v[p]=255,p=p+4|0}s.exports=function(l){var g=l.src,p=l.width,c=l.height,d=l.toWidth,_=l.toHeight,E=l.scaleX||l.toWidth/l.width,y=l.scaleY||l.toHeight/l.height,F=l.offsetX||0,U=l.offsetY||0,b=l.dest||new Uint8Array(d*_*4),C=typeof l.filter>"u"?"mks2013":l.filter,M=u(C,p,d,E,F),Q=u(C,c,_,y,U),P=new Uint16Array(d*c*4);return t(g,p,c)?(i(g,P,p,c,d,M),n(P,b,c,d,_,Q)):(r(g,P,p,c,d,M),e(P,b,c,d,_,Q),a(b,d,_)),b}},{"./convolve":2,"./resize_filter_gen":6}],6:[function(h,s,f){var u=h("./resize_filter_info"),A=14;function r(e){return Math.round(e*((1<<A)-1))}s.exports=function(i,n,t,a,v){var l=u.filter[i].fn,g=1/a,p=Math.min(1,a),c=u.filter[i].win/p,d,_,E,y,F,U,b,C,M,Q,P,k,L,j,o,I,m,B=Math.floor((c+1)*2),w=new Int16Array((B+2)*t),O=0,R=!w.subarray||!w.set;for(d=0;d<t;d++){for(_=(d+.5)*g+v,E=Math.max(0,Math.floor(_-c)),y=Math.min(n-1,Math.ceil(_+c)),F=y-E+1,U=new Float32Array(F),b=new Int16Array(F),C=0,M=E,Q=0;M<=y;M++,Q++)P=l((M+.5-_)*p),C+=P,U[Q]=P;for(k=0,Q=0;Q<U.length;Q++)L=U[Q]/C,k+=L,b[Q]=r(L);for(b[t>>1]+=r(1-k),j=0;j<b.length&&b[j]===0;)j++;if(j<b.length){for(o=b.length-1;o>0&&b[o]===0;)o--;if(I=E+j,m=o-j+1,w[O++]=I,w[O++]=m,!R)w.set(b.subarray(j,o+1),O),O+=m;else for(Q=j;Q<=o;Q++)w[O++]=b[Q]}else w[O++]=0,w[O++]=0}return w}},{"./resize_filter_info":7}],7:[function(h,s,f){var u={box:{win:.5,fn:function(r){return r<0&&(r=-r),r<.5?1:0}},hamming:{win:1,fn:function(r){if(r<0&&(r=-r),r>=1)return 0;if(r<11920929e-14)return 1;var e=r*Math.PI;return Math.sin(e)/e*(.54+.46*Math.cos(e/1))}},lanczos2:{win:2,fn:function(r){if(r<0&&(r=-r),r>=2)return 0;if(r<11920929e-14)return 1;var e=r*Math.PI;return Math.sin(e)/e*Math.sin(e/2)/(e/2)}},lanczos3:{win:3,fn:function(r){if(r<0&&(r=-r),r>=3)return 0;if(r<11920929e-14)return 1;var e=r*Math.PI;return Math.sin(e)/e*Math.sin(e/3)/(e/3)}},mks2013:{win:2.5,fn:function(r){return r<0&&(r=-r),r>=2.5?0:r>=1.5?-.125*(r-2.5)*(r-2.5):r>=.5?.25*(4*r*r-11*r+7):1.0625-1.75*r*r}}};s.exports={filter:u,f2q:{box:0,hamming:1,lanczos2:2,lanczos3:3},q2f:["box","hamming","lanczos2","lanczos3"]}},{}],8:[function(h,s,f){var u=h("./resize_filter_gen");function A(t,a,v){for(var l=3,g=a*v*4|0;l<g;){if(t[l]!==255)return!0;l=l+4|0}return!1}function r(t,a,v){for(var l=3,g=a*v*4|0;l<g;)t[l]=255,l=l+4|0}function e(t){return new Uint8Array(t.buffer,0,t.byteLength)}var i=!0;try{i=new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]===1}catch{}function n(t,a,v){if(i){a.set(e(t),v);return}for(var l=v,g=0;g<t.length;g++){var p=t[g];a[l++]=p&255,a[l++]=p>>8&255}}s.exports=function(a){var v=a.src,l=a.width,g=a.height,p=a.toWidth,c=a.toHeight,d=a.scaleX||a.toWidth/a.width,_=a.scaleY||a.toHeight/a.height,E=a.offsetX||0,y=a.offsetY||0,F=a.dest||new Uint8Array(p*c*4),U=typeof a.filter>"u"?"mks2013":a.filter,b=u(U,l,p,d,E),C=u(U,g,c,_,y),M=0,Q=Math.max(v.byteLength,F.byteLength),P=this.__align(M+Q),k=g*p*4*2,L=this.__align(P+k),j=this.__align(L+b.byteLength),o=j+C.byteLength,I=this.__instance("resize",o),m=new Uint8Array(this.__memory.buffer),B=new Uint32Array(this.__memory.buffer),w=new Uint32Array(v.buffer);B.set(w),n(b,m,L),n(C,m,j);var O=I.exports.convolveHV||I.exports._convolveHV;A(v,l,g)?O(L,j,P,l,g,p,c,1):(O(L,j,P,l,g,p,c,0),r(F,p,c));var R=new Uint32Array(F.buffer);return R.set(new Uint32Array(this.__memory.buffer,0,c*p)),F}},{"./resize_filter_gen":6}],9:[function(h,s,f){s.exports={name:"unsharp_mask",fn:h("./unsharp_mask"),wasm_fn:h("./unsharp_mask_wasm"),wasm_src:h("./unsharp_mask_wasm_base64")}},{"./unsharp_mask":10,"./unsharp_mask_wasm":11,"./unsharp_mask_wasm_base64":12}],10:[function(h,s,f){var u=h("glur/mono16");function A(r,e,i){for(var n=e*i,t=new Uint16Array(n),a,v,l,g,p=0;p<n;p++)a=r[4*p],v=r[4*p+1],l=r[4*p+2],g=a>=v&&a>=l?a:v>=l&&v>=a?v:l,t[p]=g<<8;return t}s.exports=function(e,i,n,t,a,v){var l,g,p,c,d;if(!(t===0||a<.5)){a>2&&(a=2);var _=A(e,i,n),E=new Uint16Array(_);u(E,i,n,a);for(var y=t/100*4096+.5|0,F=v<<8,U=i*n,b=0;b<U;b++)l=_[b],c=l-E[b],Math.abs(c)>=F&&(g=l+(y*c+2048>>12),g=g>65280?65280:g,g=g<0?0:g,l=l!==0?l:1,p=(g<<12)/l|0,d=b*4,e[d]=e[d]*p+2048>>12,e[d+1]=e[d+1]*p+2048>>12,e[d+2]=e[d+2]*p+2048>>12)}}},{"glur/mono16":18}],11:[function(h,s,f){s.exports=function(A,r,e,i,n,t){if(!(i===0||n<.5)){n>2&&(n=2);var a=r*e,v=a*4,l=a*2,g=a*2,p=Math.max(r,e)*4,c=8*4,d=0,_=v,E=_+l,y=E+g,F=y+g,U=F+p,b=this.__instance("unsharp_mask",v+l+g*2+p+c,{exp:Math.exp}),C=new Uint32Array(A.buffer),M=new Uint32Array(this.__memory.buffer);M.set(C);var Q=b.exports.hsv_v16||b.exports._hsv_v16;Q(d,_,r,e),Q=b.exports.blurMono16||b.exports._blurMono16,Q(_,E,y,F,U,r,e,n),Q=b.exports.unsharp||b.exports._unsharp,Q(d,d,_,E,r,e,i,t),C.set(new Uint32Array(this.__memory.buffer,0,a))}}},{}],12:[function(h,s,f){s.exports="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"},{}],13:[function(h,s,f){var u=100;function A(r,e){this.create=r,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=e||2e3}A.prototype.acquire=function(){var r=this,e;return this.available.length!==0?e=this.available.pop():(e=this.create(),e.id=this.lastId++,e.release=function(){return r.release(e)}),this.acquired[e.id]=e,e},A.prototype.release=function(r){var e=this;delete this.acquired[r.id],r.lastUsed=Date.now(),this.available.push(r),this.timeoutId===0&&(this.timeoutId=setTimeout(function(){return e.gc()},u))},A.prototype.gc=function(){var r=this,e=Date.now();this.available=this.available.filter(function(i){return e-i.lastUsed>r.idle?(i.destroy(),!1):!0}),this.available.length!==0?this.timeoutId=setTimeout(function(){return r.gc()},u):this.timeoutId=0},s.exports=A},{}],14:[function(h,s,f){var u=2;s.exports=function(r,e,i,n,t,a){var v=i/r,l=n/e,g=(2*a+u+1)/t;if(g>.5)return[[i,n]];var p=Math.ceil(Math.log(Math.min(v,l))/Math.log(g));if(p<=1)return[[i,n]];for(var c=[],d=0;d<p;d++){var _=Math.round(Math.pow(Math.pow(r,p-d-1)*Math.pow(i,d+1),1/p)),E=Math.round(Math.pow(Math.pow(e,p-d-1)*Math.pow(n,d+1),1/p));c.push([_,E])}return c}},{}],15:[function(h,s,f){var u=1e-5;function A(e){var i=Math.round(e);return Math.abs(e-i)<u?i:Math.floor(e)}function r(e){var i=Math.round(e);return Math.abs(e-i)<u?i:Math.ceil(e)}s.exports=function(i){var n=i.toWidth/i.width,t=i.toHeight/i.height,a=A(i.srcTileSize*n)-2*i.destTileBorder,v=A(i.srcTileSize*t)-2*i.destTileBorder;if(a<1||v<1)throw new Error("Internal error in pica: target tile width/height is too small.");var l,g,p,c,d,_,E=[],y;for(c=0;c<i.toHeight;c+=v)for(p=0;p<i.toWidth;p+=a)l=p-i.destTileBorder,l<0&&(l=0),d=p+a+i.destTileBorder-l,l+d>=i.toWidth&&(d=i.toWidth-l),g=c-i.destTileBorder,g<0&&(g=0),_=c+v+i.destTileBorder-g,g+_>=i.toHeight&&(_=i.toHeight-g),y={toX:l,toY:g,toWidth:d,toHeight:_,toInnerX:p,toInnerY:c,toInnerWidth:a,toInnerHeight:v,offsetX:l/n-A(l/n),offsetY:g/t-A(g/t),scaleX:n,scaleY:t,x:A(l/n),y:A(g/t),width:r(d/n),height:r(_/t)},E.push(y);return E}},{}],16:[function(h,s,f){function u(A){return Object.prototype.toString.call(A)}s.exports.isCanvas=function(r){var e=u(r);return e==="[object HTMLCanvasElement]"||e==="[object OffscreenCanvas]"||e==="[object Canvas]"},s.exports.isImage=function(r){return u(r)==="[object HTMLImageElement]"},s.exports.isImageBitmap=function(r){return u(r)==="[object ImageBitmap]"},s.exports.limiter=function(r){var e=0,i=[];function n(){e<r&&i.length&&(e++,i.shift()())}return function(a){return new Promise(function(v,l){i.push(function(){a().then(function(g){v(g),e--,n()},function(g){l(g),e--,n()})}),n()})}},s.exports.cib_quality_name=function(r){switch(r){case 0:return"pixelated";case 1:return"low";case 2:return"medium"}return"high"},s.exports.cib_support=function(r){return Promise.resolve().then(function(){if(typeof createImageBitmap>"u")return!1;var e=r(100,100);return createImageBitmap(e,0,0,100,100,{resizeWidth:10,resizeHeight:10,resizeQuality:"high"}).then(function(i){var n=i.width===10;return i.close(),e=null,n})}).catch(function(){return!1})},s.exports.worker_offscreen_canvas_support=function(){return new Promise(function(r,e){if(typeof OffscreenCanvas>"u"){r(!1);return}function i(a){if(typeof createImageBitmap>"u"){a.postMessage(!1);return}Promise.resolve().then(function(){var v=new OffscreenCanvas(10,10),l=v.getContext("2d");return l.rect(0,0,1,1),createImageBitmap(v,0,0,1,1)}).then(function(){return a.postMessage(!0)},function(){return a.postMessage(!1)})}var n=btoa("(".concat(i.toString(),")(self);")),t=new Worker("data:text/javascript;base64,".concat(n));t.onmessage=function(a){return r(a.data)},t.onerror=e}).then(function(r){return r},function(){return!1})},s.exports.can_use_canvas=function(r){var e=!1;try{var i=r(2,1),n=i.getContext("2d"),t=n.createImageData(2,1);t.data[0]=12,t.data[1]=23,t.data[2]=34,t.data[3]=255,t.data[4]=45,t.data[5]=56,t.data[6]=67,t.data[7]=255,n.putImageData(t,0,0),t=null,t=n.getImageData(0,0,2,1),t.data[0]===12&&t.data[1]===23&&t.data[2]===34&&t.data[3]===255&&t.data[4]===45&&t.data[5]===56&&t.data[6]===67&&t.data[7]===255&&(e=!0)}catch{}return e},s.exports.cib_can_use_region=function(){return new Promise(function(r){if(typeof Image>"u"||typeof createImageBitmap>"u"){r(!1);return}var e=new Image;e.src="data:image/jpeg;base64,/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRcZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRAf/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z",e.onload=function(){createImageBitmap(e,0,0,e.width,e.height).then(function(i){i.width===e.width&&i.height===e.height?r(!0):r(!1)},function(){return r(!1)})},e.onerror=function(){return r(!1)}})}},{}],17:[function(h,s,f){s.exports=function(){var u=h("./mathlib"),A;onmessage=function(e){var i=e.data.opts;if(!i.src&&i.srcBitmap){var n=new OffscreenCanvas(i.width,i.height),t=n.getContext("2d");t.drawImage(i.srcBitmap,0,0),i.src=t.getImageData(0,0,i.width,i.height).data,n.width=n.height=0,n=null,i.srcBitmap.close(),i.srcBitmap=null}A||(A=new u(e.data.features));var a=A.resizeAndUnsharp(i);postMessage({data:a},[a.buffer])}}},{"./mathlib":1}],18:[function(h,s,f){var u,A,r,e,i,n,t,a;function v(p){p<.5&&(p=.5);var c=Math.exp(.726*.726)/p,d=Math.exp(-c),_=Math.exp(-2*c),E=(1-d)*(1-d)/(1+2*c*d-_);return u=E,A=E*(c-1)*d,r=E*(c+1)*d,e=-E*_,i=2*d,n=-_,t=(u+A)/(1-i-n),a=(r+e)/(1-i-n),new Float32Array([u,A,r,e,i,n,t,a])}function l(p,c,d,_,E,y){var F,U,b,C,M,Q,P,k,L,j,o,I,m,B;for(L=0;L<y;L++){for(Q=L*E,P=L,k=0,F=p[Q],M=F*_[6],C=M,o=_[0],I=_[1],m=_[4],B=_[5],j=0;j<E;j++)U=p[Q],b=U*o+F*I+C*m+M*B,M=C,C=b,F=U,d[k]=C,k++,Q++;for(Q--,k--,P+=y*(E-1),F=p[Q],M=F*_[7],C=M,U=F,o=_[2],I=_[3],j=E-1;j>=0;j--)b=U*o+F*I+C*m+M*B,M=C,C=b,F=U,U=p[Q],c[P]=d[k]+C,Q--,k--,P-=y}}function g(p,c,d,_){if(_){var E=new Uint16Array(p.length),y=new Float32Array(Math.max(c,d)),F=v(_);l(p,E,y,F,c,d),l(E,p,y,F,d,c)}}s.exports=g},{}],19:[function(h,s,f){var u=h("object-assign"),A=h("./lib/base64decode"),r=h("./lib/wa_detect"),e={js:!0,wasm:!0};function i(n){if(!(this instanceof i))return new i(n);var t=u({},e,n||{});if(this.options=t,this.__cache={},this.__init_promise=null,this.__modules=t.modules||{},this.__memory=null,this.__wasm={},this.__isLE=new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]===1,!this.options.js&&!this.options.wasm)throw new Error('mathlib: at least "js" or "wasm" should be enabled')}i.prototype.has_wasm=r,i.prototype.use=function(n){return this.__modules[n.name]=n,this.options.wasm&&this.has_wasm()&&n.wasm_fn?this[n.name]=n.wasm_fn:this[n.name]=n.fn,this},i.prototype.init=function(){if(this.__init_promise)return this.__init_promise;if(!this.options.js&&this.options.wasm&&!this.has_wasm())return Promise.reject(new Error(`mathlib: only "wasm" was enabled, but it's not supported`));var n=this;return this.__init_promise=Promise.all(Object.keys(n.__modules).map(function(t){var a=n.__modules[t];return!n.options.wasm||!n.has_wasm()||!a.wasm_fn||n.__wasm[t]?null:WebAssembly.compile(n.__base64decode(a.wasm_src)).then(function(v){n.__wasm[t]=v})})).then(function(){return n}),this.__init_promise},i.prototype.__base64decode=A,i.prototype.__reallocate=function(t){if(!this.__memory)return this.__memory=new WebAssembly.Memory({initial:Math.ceil(t/(64*1024))}),this.__memory;var a=this.__memory.buffer.byteLength;return a<t&&this.__memory.grow(Math.ceil((t-a)/(64*1024))),this.__memory},i.prototype.__instance=function(t,a,v){if(a&&this.__reallocate(a),!this.__wasm[t]){var l=this.__modules[t];this.__wasm[t]=new WebAssembly.Module(this.__base64decode(l.wasm_src))}if(!this.__cache[t]){var g={memoryBase:0,memory:this.__memory,tableBase:0,table:new WebAssembly.Table({initial:0,element:"anyfunc"})};this.__cache[t]=new WebAssembly.Instance(this.__wasm[t],{env:u(g,v||{})})}return this.__cache[t]},i.prototype.__align=function(t,a){a=a||8;var v=t%a;return t+(v?a-v:0)},s.exports=i},{"./lib/base64decode":20,"./lib/wa_detect":21,"object-assign":22}],20:[function(h,s,f){var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";s.exports=function(r){for(var e=r.replace(/[\r\n=]/g,""),i=e.length,n=new Uint8Array(i*3>>2),t=0,a=0,v=0;v<i;v++)v%4===0&&v&&(n[a++]=t>>16&255,n[a++]=t>>8&255,n[a++]=t&255),t=t<<6|u.indexOf(e.charAt(v));var l=i%4*6;return l===0?(n[a++]=t>>16&255,n[a++]=t>>8&255,n[a++]=t&255):l===18?(n[a++]=t>>10&255,n[a++]=t>>2&255):l===12&&(n[a++]=t>>4&255),n}},{}],21:[function(h,s,f){var u;s.exports=function(){if(typeof u<"u"||(u=!1,typeof WebAssembly>"u"))return u;try{var r=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),e=new WebAssembly.Module(r),i=new WebAssembly.Instance(e,{});return i.exports.test(4)!==0&&(u=!0),u}catch{}return u}},{}],22:[function(h,s,f){var u=Object.getOwnPropertySymbols,A=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function e(n){if(n==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(n)}function i(){try{if(!Object.assign)return!1;var n=new String("abc");if(n[5]="de",Object.getOwnPropertyNames(n)[0]==="5")return!1;for(var t={},a=0;a<10;a++)t["_"+String.fromCharCode(a)]=a;var v=Object.getOwnPropertyNames(t).map(function(g){return t[g]});if(v.join("")!=="0123456789")return!1;var l={};return"abcdefghijklmnopqrst".split("").forEach(function(g){l[g]=g}),Object.keys(Object.assign({},l)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}s.exports=i()?Object.assign:function(n,t){for(var a,v=e(n),l,g=1;g<arguments.length;g++){a=Object(arguments[g]);for(var p in a)A.call(a,p)&&(v[p]=a[p]);if(u){l=u(a);for(var c=0;c<l.length;c++)r.call(a,l[c])&&(v[l[c]]=a[l[c]])}}return v}},{}],23:[function(h,s,f){var u=arguments[3],A=arguments[4],r=arguments[5],e=JSON.stringify;s.exports=function(i,n){for(var t,a=Object.keys(r),v=0,l=a.length;v<l;v++){var g=a[v],p=r[g].exports;if(p===i||p&&p.default===i){t=g;break}}if(!t){t=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var c={},v=0,l=a.length;v<l;v++){var g=a[v];c[g]=g}A[t]=["function(require,module,exports){"+i+"(self); }",c]}var d=Math.floor(Math.pow(16,8)*Math.random()).toString(16),_={};_[t]=t,A[d]=["function(require,module,exports){var f = require("+e(t)+");(f.default ? f.default : f)(self);}",_];var E={};y(d);function y(Q){E[Q]=!0;for(var P in A[Q][1]){var k=A[Q][1][P];E[k]||y(k)}}var F="("+u+")({"+Object.keys(E).map(function(Q){return e(Q)+":["+A[Q][0]+","+e(A[Q][1])+"]"}).join(",")+"},{},["+e(d)+"])",U=window.URL||window.webkitURL||window.mozURL||window.msURL,b=new Blob([F],{type:"text/javascript"});if(n&&n.bare)return b;var C=U.createObjectURL(b),M=new Worker(C);return M.objectURL=C,M}},{}],"/index.js":[function(h,s,f){function u(o,I){return n(o)||i(o,I)||r(o,I)||A()}function A(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r(o,I){if(o){if(typeof o=="string")return e(o,I);var m=Object.prototype.toString.call(o).slice(8,-1);if(m==="Object"&&o.constructor&&(m=o.constructor.name),m==="Map"||m==="Set")return Array.from(o);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return e(o,I)}}function e(o,I){(I==null||I>o.length)&&(I=o.length);for(var m=0,B=new Array(I);m<I;m++)B[m]=o[m];return B}function i(o,I){var m=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(m!=null){var B=[],w=!0,O=!1,R,S;try{for(m=m.call(o);!(w=(R=m.next()).done)&&(B.push(R.value),!(I&&B.length===I));w=!0);}catch(H){O=!0,S=H}finally{try{!w&&m.return!=null&&m.return()}finally{if(O)throw S}}return B}}function n(o){if(Array.isArray(o))return o}var t=h("object-assign"),a=h("webworkify"),v=h("./lib/mathlib"),l=h("./lib/pool"),g=h("./lib/utils"),p=h("./lib/worker"),c=h("./lib/stepper"),d=h("./lib/tiler"),_=h("./lib/mm_resize/resize_filter_info"),E={},y=!1;try{typeof navigator<"u"&&navigator.userAgent&&(y=navigator.userAgent.indexOf("Safari")>=0)}catch{}var F=1;typeof navigator<"u"&&(F=Math.min(navigator.hardwareConcurrency||1,4));var U={tile:1024,concurrency:F,features:["js","wasm","ww"],idle:2e3,createCanvas:function(I,m){var B=document.createElement("canvas");return B.width=I,B.height=m,B}},b={filter:"mks2013",unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0},C=!1,M=!1,Q=!1,P=!1,k=!1;function L(){return{value:a(p),destroy:function(){if(this.value.terminate(),typeof window<"u"){var I=window.URL||window.webkitURL||window.mozURL||window.msURL;I&&I.revokeObjectURL&&this.value.objectURL&&I.revokeObjectURL(this.value.objectURL)}}}}function j(o){if(!(this instanceof j))return new j(o);this.options=t({},U,o||{});var I="lk_".concat(this.options.concurrency);this.__limit=E[I]||g.limiter(this.options.concurrency),E[I]||(E[I]=this.__limit),this.features={js:!1,wasm:!1,cib:!1,ww:!1},this.__workersPool=null,this.__requested_features=[],this.__mathlib=null}j.prototype.init=function(){var o=this;if(this.__initPromise)return this.__initPromise;if(typeof ImageData<"u"&&typeof Uint8ClampedArray<"u")try{new ImageData(new Uint8ClampedArray(400),10,10),C=!0}catch{}typeof ImageBitmap<"u"&&(ImageBitmap.prototype&&ImageBitmap.prototype.close?M=!0:this.debug("ImageBitmap does not support .close(), disabled"));var I=this.options.features.slice();if(I.indexOf("all")>=0&&(I=["cib","wasm","js","ww"]),this.__requested_features=I,this.__mathlib=new v(I),I.indexOf("ww")>=0&&typeof window<"u"&&"Worker"in window)try{var m=h("webworkify")(function(){});m.terminate(),this.features.ww=!0;var B="wp_".concat(JSON.stringify(this.options));E[B]?this.__workersPool=E[B]:(this.__workersPool=new l(L,this.options.idle),E[B]=this.__workersPool)}catch{}var w=this.__mathlib.init().then(function(H){t(o.features,H.features)}),O;M?O=g.cib_support(this.options.createCanvas).then(function(H){if(o.features.cib&&I.indexOf("cib")<0){o.debug("createImageBitmap() resize supported, but disabled by config");return}I.indexOf("cib")>=0&&(o.features.cib=H)}):O=Promise.resolve(!1),Q=g.can_use_canvas(this.options.createCanvas);var R;M&&C&&I.indexOf("ww")!==-1?R=g.worker_offscreen_canvas_support():R=Promise.resolve(!1),R=R.then(function(H){P=H});var S=g.cib_can_use_region().then(function(H){k=H});return this.__initPromise=Promise.all([w,O,R,S]).then(function(){return o}),this.__initPromise},j.prototype.__invokeResize=function(o,I){var m=this;return I.__mathCache=I.__mathCache||{},Promise.resolve().then(function(){return m.features.ww?new Promise(function(B,w){var O=m.__workersPool.acquire();I.cancelToken&&I.cancelToken.catch(function(S){return w(S)}),O.value.onmessage=function(S){O.release(),S.data.err?w(S.data.err):B(S.data)};var R=[];o.src&&R.push(o.src.buffer),o.srcBitmap&&R.push(o.srcBitmap),O.value.postMessage({opts:o,features:m.__requested_features,preload:{wasm_nodule:m.__mathlib.__}},R)}):{data:m.__mathlib.resizeAndUnsharp(o,I.__mathCache)}})},j.prototype.__extractTileData=function(o,I,m,B,w){if(this.features.ww&&P&&(g.isCanvas(I)||k))return this.debug("Create tile for OffscreenCanvas"),createImageBitmap(B.srcImageBitmap||I,o.x,o.y,o.width,o.height).then(function(S){return w.srcBitmap=S,w});if(g.isCanvas(I))return B.srcCtx||(B.srcCtx=I.getContext("2d")),this.debug("Get tile pixel data"),w.src=B.srcCtx.getImageData(o.x,o.y,o.width,o.height).data,w;this.debug("Draw tile imageBitmap/image to temporary canvas");var O=this.options.createCanvas(o.width,o.height),R=O.getContext("2d");return R.globalCompositeOperation="copy",R.drawImage(B.srcImageBitmap||I,o.x,o.y,o.width,o.height,0,0,o.width,o.height),this.debug("Get tile pixel data"),w.src=R.getImageData(0,0,o.width,o.height).data,O.width=O.height=0,w},j.prototype.__landTileData=function(o,I,m){var B;if(this.debug("Convert raw rgba tile result to ImageData"),I.bitmap)return m.toCtx.drawImage(I.bitmap,o.toX,o.toY),null;if(C)B=new ImageData(new Uint8ClampedArray(I.data),o.toWidth,o.toHeight);else if(B=m.toCtx.createImageData(o.toWidth,o.toHeight),B.data.set)B.data.set(I.data);else for(var w=B.data.length-1;w>=0;w--)B.data[w]=I.data[w];return this.debug("Draw tile"),y?m.toCtx.putImageData(B,o.toX,o.toY,o.toInnerX-o.toX,o.toInnerY-o.toY,o.toInnerWidth+1e-5,o.toInnerHeight+1e-5):m.toCtx.putImageData(B,o.toX,o.toY,o.toInnerX-o.toX,o.toInnerY-o.toY,o.toInnerWidth,o.toInnerHeight),null},j.prototype.__tileAndResize=function(o,I,m){var B=this,w={srcCtx:null,srcImageBitmap:null,isImageBitmapReused:!1,toCtx:null},O=function(S){return B.__limit(function(){if(m.canceled)return m.cancelToken;var H={width:S.width,height:S.height,toWidth:S.toWidth,toHeight:S.toHeight,scaleX:S.scaleX,scaleY:S.scaleY,offsetX:S.offsetX,offsetY:S.offsetY,filter:m.filter,unsharpAmount:m.unsharpAmount,unsharpRadius:m.unsharpRadius,unsharpThreshold:m.unsharpThreshold};return B.debug("Invoke resize math"),Promise.resolve(H).then(function(q){return B.__extractTileData(S,o,m,w,q)}).then(function(q){return B.debug("Invoke resize math"),B.__invokeResize(q,m)}).then(function(q){return m.canceled?m.cancelToken:(w.srcImageData=null,B.__landTileData(S,q,w))})})};return Promise.resolve().then(function(){if(w.toCtx=I.getContext("2d"),g.isCanvas(o))return null;if(g.isImageBitmap(o))return w.srcImageBitmap=o,w.isImageBitmapReused=!0,null;if(g.isImage(o))return M?(B.debug("Decode image via createImageBitmap"),createImageBitmap(o).then(function(R){w.srcImageBitmap=R}).catch(function(R){return null})):null;throw new Error('Pica: ".from" should be Image, Canvas or ImageBitmap')}).then(function(){if(m.canceled)return m.cancelToken;B.debug("Calculate tiles");var R=d({width:m.width,height:m.height,srcTileSize:B.options.tile,toWidth:m.toWidth,toHeight:m.toHeight,destTileBorder:m.__destTileBorder}),S=R.map(function(q){return O(q)});function H(q){q.srcImageBitmap&&(q.isImageBitmapReused||q.srcImageBitmap.close(),q.srcImageBitmap=null)}return B.debug("Process tiles"),Promise.all(S).then(function(){return B.debug("Finished!"),H(w),I},function(q){throw H(w),q})})},j.prototype.__processStages=function(o,I,m,B){var w=this;if(B.canceled)return B.cancelToken;var O=o.shift(),R=u(O,2),S=R[0],H=R[1],q=o.length===0,J;q||_.q2f.indexOf(B.filter)<0?J=B.filter:B.filter==="box"?J="box":J="hamming",B=t({},B,{toWidth:S,toHeight:H,filter:J});var W;return q||(W=this.options.createCanvas(S,H)),this.__tileAndResize(I,q?m:W,B).then(function(){return q?m:(B.width=S,B.height=H,w.__processStages(o,W,m,B))}).then(function(ue){return W&&(W.width=W.height=0),ue})},j.prototype.__resizeViaCreateImageBitmap=function(o,I,m){var B=this,w=I.getContext("2d");return this.debug("Resize via createImageBitmap()"),createImageBitmap(o,{resizeWidth:m.toWidth,resizeHeight:m.toHeight,resizeQuality:g.cib_quality_name(_.f2q[m.filter])}).then(function(O){if(m.canceled)return m.cancelToken;if(!m.unsharpAmount)return w.drawImage(O,0,0),O.close(),w=null,B.debug("Finished!"),I;B.debug("Unsharp result");var R=B.options.createCanvas(m.toWidth,m.toHeight),S=R.getContext("2d");S.drawImage(O,0,0),O.close();var H=S.getImageData(0,0,m.toWidth,m.toHeight);return B.__mathlib.unsharp_mask(H.data,m.toWidth,m.toHeight,m.unsharpAmount,m.unsharpRadius,m.unsharpThreshold),w.putImageData(H,0,0),R.width=R.height=0,H=S=R=w=null,B.debug("Finished!"),I})},j.prototype.resize=function(o,I,m){var B=this;this.debug("Start resize...");var w=t({},b);if(isNaN(m)?m&&(w=t(w,m)):w=t(w,{quality:m}),w.toWidth=I.width,w.toHeight=I.height,w.width=o.naturalWidth||o.width,w.height=o.naturalHeight||o.height,Object.prototype.hasOwnProperty.call(w,"quality")){if(w.quality<0||w.quality>3)throw new Error("Pica: .quality should be [0..3], got ".concat(w.quality));w.filter=_.q2f[w.quality]}if(I.width===0||I.height===0)return Promise.reject(new Error("Invalid output size: ".concat(I.width,"x").concat(I.height)));w.unsharpRadius>2&&(w.unsharpRadius=2),w.canceled=!1,w.cancelToken&&(w.cancelToken=w.cancelToken.then(function(R){throw w.canceled=!0,R},function(R){throw w.canceled=!0,R}));var O=3;return w.__destTileBorder=Math.ceil(Math.max(O,2.5*w.unsharpRadius|0)),this.init().then(function(){if(w.canceled)return w.cancelToken;if(B.features.cib){if(_.q2f.indexOf(w.filter)>=0)return B.__resizeViaCreateImageBitmap(o,I,w);B.debug("cib is enabled, but not supports provided filter, fallback to manual math")}if(!Q){var R=new Error("Pica: cannot use getImageData on canvas, make sure fingerprinting protection isn't enabled");throw R.code="ERR_GET_IMAGE_DATA",R}var S=c(w.width,w.height,w.toWidth,w.toHeight,B.options.tile,w.__destTileBorder);return B.__processStages(S,o,I,w)})},j.prototype.resizeBuffer=function(o){var I=this,m=t({},b,o);if(Object.prototype.hasOwnProperty.call(m,"quality")){if(m.quality<0||m.quality>3)throw new Error("Pica: .quality should be [0..3], got ".concat(m.quality));m.filter=_.q2f[m.quality]}return this.init().then(function(){return I.__mathlib.resizeAndUnsharp(m)})},j.prototype.toBlob=function(o,I,m){return I=I||"image/png",new Promise(function(B){if(o.toBlob){o.toBlob(function(H){return B(H)},I,m);return}if(o.convertToBlob){B(o.convertToBlob({type:I,quality:m}));return}for(var w=atob(o.toDataURL(I,m).split(",")[1]),O=w.length,R=new Uint8Array(O),S=0;S<O;S++)R[S]=w.charCodeAt(S);B(new Blob([R],{type:I}))})},j.prototype.debug=function(){},s.exports=j},{"./lib/mathlib":1,"./lib/mm_resize/resize_filter_info":7,"./lib/pool":13,"./lib/stepper":14,"./lib/tiler":15,"./lib/utils":16,"./lib/worker":17,"object-assign":22,webworkify:23}]},{},[])("/index.js")})})(oe);var pe=oe.exports;const ve=ce(pe);const _e={data(){return{previewFiles:[],_images:{}}},props:{images:{}},methods:{async handleFileChange(G){const D=G.target.files,h=await this.resizeImages(D);for(let s=0;s<h.length;s++){const f=h[s],u=URL.createObjectURL(f);this.previewFiles.push({file:f,name:f.name,preview:u,progress:0,show_progress:!1,finished:!1,src:"",status:null})}this.uploadFiles()},async resizeImages(G){ve();const D=[];for(let h=0;h<G.length;h++){const s=G[h],f=await this.loadImage(s),u=document.createElement("canvas"),A=800;let r=f.width,e=f.height;r>A&&(e*=A/r,r=A),u.width=r,u.height=e,u.getContext("2d").drawImage(f,0,0,r,e);const n=await this.canvasToBlob(u,s.type);D.push(n)}return D},loadImage(G){return new Promise((D,h)=>{const s=new Image;s.onload=()=>D(s),s.onerror=h,s.src=URL.createObjectURL(G)})},canvasToBlob(G,D){return new Promise(h=>{G.toBlob(s=>h(new File([s],"resized_image.jpg",{type:D})))})},async uploadFiles(){const G=new FormData;for(let D=0;D<this.previewFiles.length;D++)this.previewFiles[D].finished||(G.append("files[]",this.previewFiles[D].file),G.append("index[]",D),this.previewFiles[D].finished=!0,this.previewFiles[D].show_progress=!0);try{await this.$http.post("/upload",G,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:D=>{const h=Math.round(D.loaded*100/D.total);this.updateFileProgress(this.previewFiles,h)}}).then(D=>{D.data.map(s=>{console.log("Upload concluído:",s),this.previewFiles[s.index].file_name=s.file_name,this.previewFiles[s.index].status=s.status,this.previewFiles[s.index].show_progress=!1,this.previewFiles[s.index].error=s.error??null}),this.$emit("response",this.previewFiles)})}catch{}},updateFileProgress(G,D){for(let h=0;h<G.length;h++)G[h].progress=D}},watch:{images:function(G){this._images=G}}},ee=G=>(fe("data-v-5b5aaaf5"),G=G(),he(),G),Ie={class:"overflow-x-auto"},we=ee(()=>x("label",{class:"fw-bold"},"Imagens",-1)),Be={class:"d-flex"},Ee={class:"preview d-flex justify-content-center align-items-center overflow-hidden m-2 shadow-sm position-relative"},be=["onUpdate:modelValue"],Qe=["src","alt"],Ce={key:0,class:"progress"},ye={key:1,class:"messages"},xe={key:0,class:"d-flex align-items-center text-success bg-light rounded rounded-lg p-1"},Fe=ee(()=>x("small",null,"Sucesso!",-1)),Me={key:1,class:"d-flex align-items-center text-danger bg-light rounded rounded-lg p-1"},De=ee(()=>x("small",null,[X(" Erro! "),x("span",{class:"small"})],-1)),ke={class:"d-flex justify-content-center align-items-center img position-relative"},Ue=["src","alt"],Re=["onUpdate:modelValue"];function Ge(G,D,h,s,f,u){const A=se("font-awesome-icon");return z(),T("div",Ie,[we,x("div",Be,[x("div",Ee,[x("input",{type:"file",ref:"fileInput",multiple:"",onChange:D[0]||(D[0]=(...r)=>u.handleFileChange&&u.handleFileChange(...r)),id:"fileInput",accept:"image/*"},null,544),Y(A,{icon:"plus-circle",style:{"font-size":"40px"}})]),(z(!0),T(K,null,$(f._images,(r,e)=>(z(),T("div",{key:e,class:"preview d-flex justify-content-center align-items-center overflow-hidden m-2 shadow-sm position-relative"},[Y(A,{icon:"trash",class:"me-1 destroy text-danger",onClick:i=>G.$util.deleteById(f._images,r.id),style:{"font-size":"20px"}},null,8,["onClick"]),N(x("input",{name:"file_name[]",type:"hidden","onUpdate:modelValue":i=>r.src.name=i},null,8,be),[[V,r.src.name]]),x("img",{class:"img-fluid",src:r.src.full_src,alt:r.src.full_src},null,8,Qe)]))),128)),(z(!0),T(K,null,$(f.previewFiles,(r,e)=>(z(),T("div",{key:r.name,class:"preview overflow-hidden m-2 shadow-sm position-relative"},[r.show_progress?(z(),T("div",Ce,[x("div",{class:"progress-bar",role:"progressbar",style:le("width: "+r.progress+"%"),"aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100"},null,4)])):te("",!0),r.status!=null?(z(),T("div",ye,[r.status?(z(),T("div",xe,[Y(A,{icon:"check-circle",class:"me-1",style:{"font-size":"20px"}}),Fe])):(z(),T("div",Me,[Y(A,{icon:"times-circle",class:"me-1",style:{"font-size":"20px"}}),De]))])):te("",!0),x("div",ke,[Y(A,{icon:"trash",class:"me-1 destroy text-danger",onClick:i=>G.$util.deleteByIndex(f.previewFiles,e),style:{"font-size":"20px"}},null,8,["onClick"]),x("img",{class:"img-fluid",src:r.preview,alt:r.name},null,8,Ue)]),N(x("input",{name:"file_name[]",type:"hidden","onUpdate:modelValue":i=>r.file_name=i},null,8,Re),[[V,r.file_name]])]))),128))])])}const Se=ne(_e,[["render",Ge],["__scopeId","data-v-5b5aaaf5"]]);var Ae={exports:{}};(function(G,D){(function(h,s){G.exports=s()})(de,function(){return function(h){function s(u){if(f[u])return f[u].exports;var A=f[u]={i:u,l:!1,exports:{}};return h[u].call(A.exports,A,A.exports,s),A.l=!0,A.exports}var f={};return s.m=h,s.c=f,s.i=function(u){return u},s.d=function(u,A,r){s.o(u,A)||Object.defineProperty(u,A,{configurable:!1,enumerable:!0,get:r})},s.n=function(u){var A=u&&u.__esModule?function(){return u.default}:function(){return u};return s.d(A,"a",A),A},s.o=function(u,A){return Object.prototype.hasOwnProperty.call(u,A)},s.p=".",s(s.s=9)}([function(h,s,f){s.a={prefix:"",suffix:"",thousands:",",decimal:".",precision:2}},function(h,s,f){var u=f(2),A=f(5),r=f(0);s.a=function(e,i){if(i.value){var n=f.i(A.a)(r.a,i.value);if(e.tagName.toLocaleUpperCase()!=="INPUT"){var t=e.getElementsByTagName("input");t.length!==1||(e=t[0])}e.oninput=function(){var a=e.value.length-e.selectionEnd;e.value=f.i(u.a)(e.value,n),a=Math.max(a,n.suffix.length),a=e.value.length-a,a=Math.max(a,n.prefix.length+1),f.i(u.b)(e,a),e.dispatchEvent(f.i(u.c)("change"))},e.onfocus=function(){f.i(u.b)(e,e.value.length-n.suffix.length)},e.oninput(),e.dispatchEvent(f.i(u.c)("input"))}}},function(h,s,f){function u(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p.a;typeof c=="number"&&(c=c.toFixed(e(d.precision)));var _=c.indexOf("-")>=0?"-":"",E=r(c),y=n(E,d.precision),F=v(y).split("."),U=F[0],b=F[1];return U=t(U,d.thousands),d.prefix+_+a(U,b,d.decimal)+d.suffix}function A(c,d){var _=c.indexOf("-")>=0?-1:1,E=r(c),y=n(E,d);return parseFloat(y)*_}function r(c){return v(c).replace(/\D+/g,"")||"0"}function e(c){return i(0,c,20)}function i(c,d,_){return Math.max(c,Math.min(d,_))}function n(c,d){var _=Math.pow(10,d);return(parseFloat(c)/_).toFixed(e(d))}function t(c,d){return c.replace(/(\d)(?=(?:\d{3})+\b)/gm,"$1"+d)}function a(c,d,_){return d?c+_+d:c}function v(c){return c?c.toString():""}function l(c,d){var _=function(){c.setSelectionRange(d,d)};c===document.activeElement&&(_(),setTimeout(_,1))}function g(c){var d=document.createEvent("Event");return d.initEvent(c,!0,!0),d}var p=f(0);f.d(s,"a",function(){return u}),f.d(s,"d",function(){return A}),f.d(s,"b",function(){return l}),f.d(s,"c",function(){return g})},function(h,s,f){function u(t,a){a&&Object.keys(a).map(function(v){i.a[v]=a[v]}),t.directive("money",e.a),t.component("money",r.a)}Object.defineProperty(s,"__esModule",{value:!0});var A=f(6),r=f.n(A),e=f(1),i=f(0);f.d(s,"Money",function(){return r.a}),f.d(s,"VMoney",function(){return e.a}),f.d(s,"options",function(){return i.a}),f.d(s,"VERSION",function(){return n});var n="0.8.1";s.default=u,typeof window<"u"&&window.Vue&&window.Vue.use(u)},function(h,s,f){Object.defineProperty(s,"__esModule",{value:!0});var u=f(1),A=f(0),r=f(2);s.default={name:"Money",props:{value:{required:!0,type:[Number,String],default:0},masked:{type:Boolean,default:!1},precision:{type:Number,default:function(){return A.a.precision}},decimal:{type:String,default:function(){return A.a.decimal}},thousands:{type:String,default:function(){return A.a.thousands}},prefix:{type:String,default:function(){return A.a.prefix}},suffix:{type:String,default:function(){return A.a.suffix}}},directives:{money:u.a},data:function(){return{formattedValue:""}},watch:{value:{immediate:!0,handler:function(e,i){var n=f.i(r.a)(e,this.$props);n!==this.formattedValue&&(this.formattedValue=n)}}},methods:{change:function(e){this.$emit("input",this.masked?e.target.value:f.i(r.d)(e.target.value,this.precision))}}}},function(h,s,f){s.a=function(u,A){return u=u||{},A=A||{},Object.keys(u).concat(Object.keys(A)).reduce(function(r,e){return r[e]=A[e]===void 0?u[e]:A[e],r},{})}},function(h,s,f){var u=f(7)(f(4),f(8),null,null);h.exports=u.exports},function(h,s){h.exports=function(f,u,A,r){var e,i=f=f||{},n=typeof f.default;n!=="object"&&n!=="function"||(e=f,i=f.default);var t=typeof i=="function"?i.options:i;if(u&&(t.render=u.render,t.staticRenderFns=u.staticRenderFns),A&&(t._scopeId=A),r){var a=t.computed||(t.computed={});Object.keys(r).forEach(function(v){var l=r[v];a[v]=function(){return l}})}return{esModule:e,exports:i,options:t}}},function(h,s){h.exports={render:function(){var f=this,u=f.$createElement;return(f._self._c||u)("input",{directives:[{name:"money",rawName:"v-money",value:{precision:f.precision,decimal:f.decimal,thousands:f.thousands,prefix:f.prefix,suffix:f.suffix},expression:"{precision, decimal, thousands, prefix, suffix}"}],staticClass:"v-money",attrs:{type:"tel"},domProps:{value:f.formattedValue},on:{change:f.change}})},staticRenderFns:[]}},function(h,s,f){h.exports=f(3)}])})})(Ae);var ie=Ae.exports;const Oe={components:{VMoney:ie.VMoney,FileUploadInput:Se},data(){return{product:{},brands:{},images:[],money:this.$util.money}},methods:{async init(){this.$store.commit("setLoading",{status:!0});let G="/products/create";this.product_id!=null&&(G="/products/"+this.product_id+"/edit"),this.$http.get(G).then(D=>{let h=D.data;this.product=h.product??{},this.brands=h.brands??{},this.$store.commit("setLoading",{status:!1})})},async save(G){G.preventDefault(),this.$util.validate("form")&&(this.$store.commit("setLoading",{status:!0}),this.setImages(),this.product_id==null?this.$http.post("/products",ae.stringify(this.product)).then(h=>{let s=h.data;this.$util.toast(s),this.$store.commit("setLoading",{status:!1}),this.$router.push({name:"products"})}).catch(h=>{h.response&&(h.response.status===422||h.response.status===404)&&(this.$util.toast(h.response.data),this.$store.commit("setLoading",{status:!1}))}):this.$http.put("/products/"+this.product_id,ae.stringify(this.product)).then(h=>{let s=h.data;this.$util.toast(s),this.$store.commit("setLoading",{status:!1}),this.$router.push({name:"products"})}).catch(h=>{h.response&&(h.response.status===422||h.response.status===404)&&(this.$util.toast(h.response.data),this.$store.commit("setLoading",{status:!1}))}))},setImages(){this.product.file_name=[],this.product.images&&this.product.images.map(G=>{this.product.file_name.push(G.src.name)}),this.images&&this.images.map(G=>{this.product.file_name.push(G.file_name)})},getImages(G){console.log(G),this.images=G}},mounted(){this.product_id=this.$route.params.id!="undefined"?this.$route.params.id:null,this.init()},directives:{money:ie.VMoney}},Pe=x("div",{class:"d-flex justify-content-between mt-3"},[x("h3",null,"Cadastrar Eletrodoméstico")],-1),je={id:"form"},He={class:"card mt-3"},Le={class:"card-body"},qe={class:"row justify-content-center"},ze={class:"col-md-8"},Te={class:"row"},Ne={class:"col-12"},We={class:"mb-3"},Ye=x("label",{for:"name",class:"form-label fw-bold"},[X("Título "),x("span",{class:"text-danger"},"*")],-1),Ve={class:"col-md-4 col-12"},Xe={class:"mb-3"},Je=x("label",{for:"brand",class:"form-label fw-bold"},[X("Marca "),x("span",{class:"text-danger"},"*")],-1),Ze=x("option",{value:"",selected:""},"Selecione...",-1),Ke=["value"],$e={class:"col-md-4 col-12"},et={class:"mb-3"},tt=x("label",{for:"value",class:"form-label fw-bold"},[X("Preço "),x("span",{class:"text-danger"},"*")],-1),rt={class:"col-md-4 col-12"},at={class:"mb-3"},it=x("label",{for:"voltage",class:"form-label fw-bold"},[X("Voltagem "),x("span",{class:"text-danger"},"*")],-1),nt=x("option",{value:"",selected:""},"Selecione...",-1),st=x("option",{value:"bivolt"},"bivolt",-1),ot=x("option",{value:"110V"},"110V",-1),At=x("option",{value:"220V"},"220V",-1),ut=[nt,st,ot,At],ct={class:"col-12"},lt={class:"mb-3"},ft=x("label",{for:"description",class:"form-label fw-bold"},"Descrição",-1),ht={class:"card-footer"},dt={class:"d-flex justify-content-center"};function gt(G,D,h,s,f,u){const A=se("FileUploadInput"),r=ge("money");return z(),T("div",null,[Pe,x("form",je,[x("div",He,[x("div",Le,[x("div",qe,[x("div",ze,[Y(A,{images:f.product.images,onResponse:u.getImages},null,8,["images","onResponse"]),x("div",Te,[x("div",Ne,[x("div",We,[Ye,N(x("input",{"onUpdate:modelValue":D[0]||(D[0]=e=>f.product.name=e),type:"text",class:"form-control form-control-lg",id:"name",placeholder:"Digite o nome do Eletrodoméstico",required:""},null,512),[[V,f.product.name]])])]),x("div",Ve,[x("div",Xe,[Je,N(x("select",{"onUpdate:modelValue":D[1]||(D[1]=e=>f.product.brand_id=e),class:"form-select form-select-lg mb-3",id:"brand",required:""},[Ze,(z(!0),T(K,null,$(f.brands,e=>(z(),T("option",{key:e.id,value:e.id},me(e.name),9,Ke))),128))],512),[[re,f.product.brand_id]])])]),x("div",$e,[x("div",et,[tt,N(x("input",{"onUpdate:modelValue":D[2]||(D[2]=e=>f.product.value=e),type:"text",class:"form-control form-control-lg",id:"value",required:""},null,512),[[V,f.product.value],[r,f.money,void 0,{lazy:!0}]])])]),x("div",rt,[x("div",at,[it,N(x("select",{"onUpdate:modelValue":D[3]||(D[3]=e=>f.product.voltage=e),class:"form-select form-select-lg mb-3",id:"voltage",required:""},ut,512),[[re,f.product.voltage]])])]),x("div",ct,[x("div",lt,[ft,N(x("textarea",{"onUpdate:modelValue":D[4]||(D[4]=e=>f.product.description=e),class:"form-control",id:"description",rows:"4"},null,512),[[V,f.product.description]])])])])])])]),x("div",ht,[x("div",dt,[x("button",{class:"btn btn-primary btn-lg",onClick:D[5]||(D[5]=(...e)=>u.save&&u.save(...e))},"Salvar")])])])])])}const vt=ne(Oe,[["render",gt]]);export{vt as default};
